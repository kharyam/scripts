#!/bin/bash
oc adm drain node5.ocp.khary.net --ignore-daemonsets --delete-emptydir-data --kubeconfig=${HOME}/kubeconfig-noingress --grace-period=0 --force

sudo dnf update -y
flatpak update -y
sudo snap refresh
~/bin/commit.sh

# Rebuild obs
# https://github.com/obsproject/obs-studio/wiki/build-instructions-for-linux
cd ${HOME}/Projects/local/obs/obs-studio
git pull
git submodule update
cd ${HOME}/Projects/local/obs/obs-studio/build
cmake -DENABLE_BROWSER=ON -DCEF_ROOT_DIR="../../cef_binary_5060_linux64" -DENABLE_AJA=OFF -DENABLE_NEW_MPEGTS_OUTPUT=OFF -DENABLE_WEBRTC=OFF -DCMAKE_POSITION_INDEPENDENT_CODE=ON ..
make -j16
sudo make install
#echo "/usr/local/lib" | sudo tee /etc/ld.so.conf.d/local.conf -a
sudo ldconfig
sudo cp UI/obs /usr/local/bin


sudo shutdown now
